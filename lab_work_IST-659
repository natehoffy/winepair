DROP TABLE IF EXISTS Product;

CREATE TABLE IF NOT EXISTS Product (
	ProductID INT NOT NULL,
	ProductName CHAR(30) NOT NULL,
	ProductDescription VARCHAR(255),
	QtyOnHand INT NOT NULL,
	
	PRIMARY KEY (ProductID)
);

DESCRIBE Product;

ALTER TABLE Product DROP ProductID; 
ALTER TABLE Product ADD ProductID INT PRIMARY KEY AUTO_INCREMENT FIRST;
DROP TABLE IF EXISTS Vendor;

CREATE TABLE IF NOT EXISTS Vendor (
	VendorID INT NOT NULL AUTO_INCREMENT,
	VendorName CHAR(30),
	
	PRIMARY KEY (VendorID),
	UNIQUE INDEX (VendorID)
);

DROP TABLE IF EXISTS VendorProduct;

CREATE TABLE IF NOT EXISTS VendorProduct (
	VendorProductID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
	Cost DECIMAL(12,4) NOT NULL,
	ProductID INT NOT NULL,
	VendorID INT NOT NULL,
	
	FOREIGN KEY (ProductID) REFERENCES Product(ProductID) ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (VendorID) REFERENCES Vendor(VendorID) ON DELETE CASCADE ON UPDATE CASCADE
);

INSERT INTO Vendor (VendorName)
	VALUES 
		('Spikey'),
		('Tweebox'),
		('Ernder Ermer');
		
DESCRIBE VendorProduct;

SELECT * FROM Product;
SELECT * FROM Vendor;

INSERT INTO VendorProduct (Cost, ProductID, VendorID)
	VALUES
		(50, (SELECT ProductID FROM Product WHERE ProductName = 'Red Shoes'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Spikey')),
		(45, (SELECT ProductID FROM Product WHERE ProductName = 'Blue Shoes'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Spikey')),
		(30, (SELECT ProductID FROM Product WHERE ProductName = 'Green Shoes'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Spikey')),
		(55, (SELECT ProductID FROM Product WHERE ProductName = 'Red Shoes'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Tweebox')),
		(20, (SELECT ProductID FROM Product WHERE ProductName = 'Green Hat'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Tweebox')),
		(60, (SELECT ProductID FROM Product WHERE ProductName = 'Red Shoes'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Ernder Ermer')),
		(25, (SELECT ProductID FROM Product WHERE ProductName = 'Green Hat'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Ernder Ermer'));
		(0, (SELECT ProductID FROM Product WHERE ProductName = 'Blue Shorts'), (SELECT VendorID FROM Vendor WHERE VendorName = 'Spikey')),
		
		
SELECT * FROM VendorProduct;

Select * FROM Product;

SELECT Product.ProductName, Vendor.VendorName, VendorProduct.Cost
	FROM Product
	JOIN VendorProduct ON VendorProduct.ProductID = Product.ProductID
	JOIN Vendor ON Vendor.VendorID = VendorProduct.VendorID;
 		
SELECT Product.ProductName AS 'Product Name', AVG(VendorProduct.Cost) AS 'Average Cost', MIN(VendorProduct.Cost) AS 'Minimum Cost', MAX(VendorProduct.Cost) AS 'Maximum Cost'
	FROM Product
	JOIN VendorProduct ON VendorProduct.ProductID = Product.ProductID
	JOIN Vendor ON Vendor.VendorID = VendorProduct.VendorID
	GROUP BY Product.ProductName;



